(function(t){function e(e){for(var a,i,s=e[0],c=e[1],l=e[2],d=0,u=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&u.push(n[i][0]),n[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);p&&p(e);while(u.length)u.shift()();return o.push.apply(o,l||[]),r()}function r(){for(var t,e=0;e<o.length;e++){for(var r=o[e],a=!0,s=1;s<r.length;s++){var c=r[s];0!==n[c]&&(a=!1)}a&&(o.splice(e--,1),t=i(i.s=r[0]))}return t}var a={},n={app:0},o=[];function i(e){if(a[e])return a[e].exports;var r=a[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=a,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(r,a,function(e){return t[e]}.bind(null,a));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var p=c;o.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{attrs:{id:"app"}},[r("div",{staticClass:"section ml-2"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-3 toolbox"},[r("p",{staticClass:"text-center bg-secondary mb-0 p-1"},[t._v("口罩剩餘數量明細清單 資料來源:衛服部")]),r("div",{staticClass:"sticky-top shadow-sm p-2"},[r("div",{staticClass:"citySelect"},[r("select",{directives:[{name:"model",rawName:"v-model",value:t.select.filter,expression:"select.filter"}],staticClass:"custom-select custom-select-lg mb-3",on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.select,"filter",e.target.multiple?r:r[0])}}},[r("option",{attrs:{selected:""}},[t._v("Open this select menu")]),t._l(t.cityFilter,(function(e,a){return r("option",{key:a,domProps:{value:e}},[t._v(t._s(e))])}))],2)]),r("div",{staticClass:"TownSelect"},[r("select",{directives:[{name:"model",rawName:"v-model",value:t.select.filter2,expression:"select.filter2"}],staticClass:"custom-select custom-select-lg mb-3",on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.select,"filter2",e.target.multiple?r:r[0])}}},t._l(t.townFilter,(function(e,a){return r("option",{key:a,domProps:{value:e}},[t._v(" "+t._s(e)+" ")])})),0)])]),r("div",{staticClass:"cardGroup"},t._l(t.filterData,(function(e,a){return r("Card",{key:a,attrs:{store:e},on:{switchcard:t.switchGeo,switchshare:t.dayBegin}})})),1)]),r("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}},[r("div",{staticClass:"col-md-9"},[t.status.fileUploading?r("i",{staticClass:"fas fa-sync fa-spin fa-3x"}):t._e()])]),t._m(0)],1)])])])},o=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"col-md-9"},[r("div",{attrs:{id:"map"}})])}],i=(r("99af"),r("4de4"),r("7db0"),r("c740"),r("4160"),r("c975"),r("d81d"),r("a434"),r("b0c0"),r("d3b7"),r("ac1f"),r("3ca3"),r("1276"),r("159b"),r("ddb0"),r("3835")),s=r("5530"),c=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"card mt-2",on:{click:t.setFocus}},[r("div",{staticClass:"card-body",class:t.store.properties.mask_adult>30?"hightlight":"normal"},[r("h4",{staticClass:"card-title mt-3"},[t._v(t._s(t.store.properties.name))]),r("p",[r("i",{staticClass:"fas fa-home mr-2"}),r("a",{attrs:{href:t.getHref(t.store.properties.address),target:"_blank"}},[t._v(t._s(t.store.properties.address))])]),r("p",[r("i",{staticClass:"fas fa-phone mr-2 mt-1"}),r("a",{attrs:{href:"tel:+886-${store.properties.phone}"}},[t._v(t._s(t.store.properties.phone))])]),r("small",{staticClass:"card-text"},[t._v("最後更新時間: "+t._s(t.store.properties.updated))])])]),r("div",{staticClass:"bottom pt-1 pb-1",on:{click:t.clickHandler}},[r("i",{staticClass:"fas fa-share-alt mt-1"}),r("p",{staticClass:"card-text"},[t._v("成人口罩: "+t._s(t.store.properties.mask_adult)+" | 兒童口罩: "+t._s(t.store.properties.mask_child))])])])},l=[],p={name:"Card",props:["store"],methods:{getHref:function(t){return"https://www.google.com.tw/maps/place/".concat(t)},setFocus:function(){this.$emit("switchcard",this.store)},clickHandler:function(){this.$emit("switchshare",this.store)}}},d=p,u=(r("9037"),r("2877")),f=Object(u["a"])(d,c,l,!1,null,"058b6be4",null),m=f.exports,h=r("e11e"),g=r.n(h),v=(r("6cc5"),r("2573"),{}),y={iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},b={green:new g.a.Icon(Object(s["a"])({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png"},y)),grey:new g.a.Icon(Object(s["a"])({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-grey.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png"},y)),red:new g.a.Icon(Object(s["a"])({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png"},y))},w={name:"App",data:function(){return{dataAry:[],city:[],cityFilter:[],town:[],townFilter:[],cityName:[],osmMap:{},geoInfo:[],markers:[],available:[],isLoading:!0,select:{filter:"新北市",filter2:"新店區"},status:{fileUploading:!0},iconData:b}},methods:{initialMap:function(){v=g.a.map("map",{center:[24.956111,121.5365],zoom:18}),g.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'© <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(v)},switchGeo:function(t){var e=t.geometry.coordinates[1],r=t.geometry.coordinates[0];v.flyTo(new g.a.LatLng(e,r)),g.a.marker([e,r]).addTo(v).bindPopup("<h4>".concat(t.properties.name,"</h4>\n              <p>\n                 成人口罩:<mark>").concat(t.properties.mask_adult,"</mark><br>\n                 兒童口罩:").concat(t.properties.mask_child,'<br>\n                 診所電話:\n                 <a href="tel:+886-').concat(t.properties.phone,'">').concat(t.properties.phone,"</a>\n              </p>")).openPopup()},dayBegin:function(t){var e=t.properties.available.split("、");this.timeArr=e.map((function(t){return t.indexOf("看")>=1?"O":"X"})),console.log(this.timeArr)},filterColor:function(t){switch(!0){case t>=10:return this.iconData.green;case t<10&&t>0:return this.iconData.red;case 0==t:return this.iconData.grey}},dataCreated:function(){this.status.fileUploading=!0,this.isLoading=!0;for(var t=(new g.a.MarkerClusterGroup).addTo(v),e=0;e<this.geoInfo.length;e++)this.status.fileUploading=!1,this.isLoading=!1,t.addLayer(g.a.marker([this.geoInfo[e].lng,this.geoInfo[e].lat],{icon:this.filterColor(this.geoInfo[e].adult)}).bindPopup("<h3>".concat(this.geoInfo[e].name,"</h3>\n                              <p>\n                                成人口罩:").concat(this.geoInfo[e].adult,"  \n                                兒童口罩:").concat(this.geoInfo[e].child,"\n                                診所電話:").concat(this.geoInfo[e].phone,"\n                              </p>")));v.addLayer(t)}},computed:{filterData:function(){var t=this;return"Open this select menu"==t.select.filter?t.dataAry:(t.town.length=0,t.dataAry.find((function(e){t.select.filter===e.properties.county&&t.town.push(e.properties.town)})),t.townFilter=t.town.filter((function(e,r,a){return t.town.indexOf(e)===r})),t.dataAry.filter((function(e){return e.properties.county==t.select.filter&&e.properties.town==t.select.filter2})))}},mounted:function(){var t=this;this.initialMap(),Promise.all([this.axios.get("https://raw.githubusercontent.com/kiang/pharmacies/master/json/points.json?fbclid=IwAR0TSsgLIAH10XrE6fFk7bRmXyxXd_FK4NZO39yOkcS28rpVfCkQZJit0Dc"),this.$http.get("cityName.json")]).then((function(e){var r=Object(i["a"])(e,2),a=r[0],n=r[1];t.cityName=n.data,t.dataAry=a.data.features,t.dataAry.forEach((function(e){return t.city.push(e.properties.county)})),t.cityFilter=t.city.filter((function(e,r,a){return t.city.indexOf(e)===r}));var o=t.cityFilter.findIndex((function(t){return""===t}));t.cityFilter.splice(o,1),t.dataAry.forEach((function(e){return t.geoInfo.push({name:e.properties.name,lat:e.geometry.coordinates[0],lng:e.geometry.coordinates[1],adult:e.properties.mask_adult,child:e.properties.mask_child,phone:e.properties.phone})})),t.dataCreated()}))},components:{Card:m}},_=w,k=(r("5c0b"),Object(u["a"])(_,n,o,!1,null,null,null)),C=k.exports,x=r("bc3a"),O=r.n(x),j=r("a7fe"),A=r.n(j),I=r("ebfd"),P=r.n(I),F=r("9062"),L=r.n(F);r("e40d"),r("15f5"),r("7051");a["a"].use(A.a,O.a),a["a"].use(P.a),a["a"].component("Loading",L.a),a["a"].config.productionTip=!1,new a["a"]({render:function(t){return t(C)}}).$mount("#app")},"5c0b":function(t,e,r){"use strict";var a=r("9c0c"),n=r.n(a);n.a},9037:function(t,e,r){"use strict";var a=r("ade2"),n=r.n(a);n.a},"9c0c":function(t,e,r){},ade2:function(t,e,r){}});
//# sourceMappingURL=app.979b94f5.js.map